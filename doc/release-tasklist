- Tasklist:
  . leading up to a release:
    . send out an email about problems or outstanding patches
    . go through the list of TODOs in the source code and see what can be done
    . make sure the description of the interfaces that need to be updated
      are up to date in the manual
    . update the used deal.II version for the Docker container in docker/Dockerfile
      and in the manual
    . check that README.md and http://aspect.dealii.org/ReadMe.html are okay
      and the links to the mailinglists are working (also in manual.pdf)
    . run (and be patient):
      cd benchmarks && make -f check.mk BUILD=$BUILDDIR -j4
      cd cookbooks && make -f check.mk BUILD=$BUILDDIR -j4
  . determine new version roughly following semantic versioning: http://semver.org/
    - format is X.Y.Z for a release, X.Y.Z-pre for the dev version or X.Y.Z-rcW for release candidates
    - backwards incompatible changes require incrementing X, adding features incrementing Y
  . setup:
      export OLDVER=2.0.0;export VER=2.1.0;export VERSHORT=2.1;export NEXTVER=2.2.0-pre
      export DEALSRCDIR=/ssd/deal-git/
  . fix doxygen errors:
      find include -name "*h" -print | xargs -n 1 $DEALSRCDIR/contrib/utilities/checkdoxygen.py
    and commit.
  . manual, check for missing labels:
    . cd doc
    . make manual.pdf
    . grep undefined manual/manual.log    # try to remove some
    . make aspect.tag
    . and check for warnings
  . fix formatting, copyright years:
      find . -name "*.h" -print | while read file;do $DEALSRCDIR/contrib/utilities/wrapcomments.py $file >temp;mv temp $file;done
      . note: we started ignoring the rewrapping of comments, but we should still fix wrong indentation or other problems
      ./contrib/utilities/indent
      ./doc/update_copyright.sh
      git commit -a -m "doxygen formatting, comment wrapping"
      # create a pull-request
  . create branch for master PR to update changes.h in doc/modules:
      git checkout -b post-release-$VER
      cd doc/modules; rm -f changes/*~; ./increment_version.sh $OLDVER $VER;cd ../..
      cd doc;./bump_version.sh $NEXTVER; cd ..
      git commit -m "release task: update version and changes.h"
      # create a PR
  . create a branch, bump version (note, make sure the PR above is included)
      git checkout post-release-$VER && \
      git checkout -b aspect-$VERSHORT && \
      cd doc && ./bump_version.sh $VER && cd .. && \
      git commit -m "release task: update version info"
  . compile aspect, make sure you have a symlink in the main directory for the next step
    - make sure the WorldBuilder is found! (git submodule init)
  . update doc/manual/parameters.tex and documentation:
      cd doc && ./update_parameters.sh && make manual.pdf && cp manual.pdf manual-$VER.pdf && cd .. && \
      git add doc/manual/parameters.tex && \
      git commit -m "release task: update manual"
  . Tag an RC:
      export TAG=$VER-rc1
      cd doc && ./bump_version.sh $TAG && cd .. && \
      git commit -m "version $TAG" && \
      git tag -s v$TAG -m "version $TAG"
  . Tag the release:
      export TAG=$VER
      cd doc && ./bump_version.sh $TAG && cd .. && \
      git commit -m "version $TAG" && \
      git tag -s v$TAG -m "version $TAG"
  . create a tar file:
      cd doc && make manual.pdf && cp manual.pdf aspect-manual-$TAG.pdf && cd ..
      export PREFIX=aspect-$TAG && rm -rf $PREFIX.tar.gz && \
      git archive --format=tar.gz --prefix=$PREFIX/ HEAD >temp.tar.gz && \
      rm -fr $PREFIX/ && \
      tar xf temp.tar.gz && \
      cd contrib/WorldBuilder/ && \
      git archive --format=tar.gz --prefix=$PREFIX/contrib/WorldBuilder/ HEAD >temp.tar.gz && \
      cd ../.. && \
      tar xf contrib/WorldBuilder/temp.tar.gz && \
      tar czf $PREFIX.tar.gz $PREFIX/ && \
      rm -rf contrib/WorldBuilder/temp.tar.gz

  . final testing by extracting tarball, compiling, and running:
      tar xf $PREFIX.tar.gz
      cd $PREFIX
      docker run --rm -it -v `pwd`:/home/dealii/aspect \
      	     dealii/dealii:v8.5.0-gcc-mpi-fulldepscandi-debugrelease /bin/bash

      mkdir build; cd build
      cmake -G "Ninja" -D ASPECT_RUN_ALL_TESTS=ON -D \
            ASPECT_PRECOMPILE_HEADERS=ON ~/aspect
      ninja; ctest -j 8 -V

  . make public (branch and tag):
      git push cig aspect-$VERSHORT
      git push cig v$TAG
  . sign:
      gpg --detach-sign --armor aspect-$TAG.tar.gz
      sha1sum aspect-$TAG.tar.gz
      gpg --detach-sign --armor aspect-manual-$TAG.pdf
      sha1sum aspect-$TAG.tar.gz aspect-manual-$TAG.pdf >sha1sum-$TAG.txt
  . create a release on github, upload tar.gz and manual-$VER.pdf
  . update website (www repo):
    - header.include: add link to changes
    - index.html: add news entry
  . create zenodo release for source code:
    - https://zenodo.org/deposit?page=1&size=20
    - title: ASPECT v2.0.0
    - license: GPL 2
    - check CIG comments: https://github.com/geodynamics/best_practices/blob/master/ZenodoBestPractices.md
    - cig community!
    - update zenodo badge in README.md to newest version (see badge button on the right of zenodo page)
    - add zenodo badge also to the release on github (on top, see 2.0.1 for an example)
    - readme / release notes: add zenodo DOI button
  . create figshare DOI for manual
  . update doc/manual/manual.bib with src and manual doi
  . update aspect.geodynamics.org/cite.html and citing.html in www repo:
    - change link in cite.html
    - add new version in citing.html, search for "<option"
    - run aspect/doc/ python3 make_cite_html.py add to www
  . update http://geodynamics.org/cig/software/aspect/:
       update current release number
       create entry for the new release
       update the list of contributors
       ... (to be completed when we go through the 2.0 release process)
  . update docker image geodynamics/aspect:
    - modify docker/Dockerfile and docker/build.sh to checkout the release
      cd docker && ./build.sh
      docker push geodynamics/aspect:v$TAG
  . update the spack installation package with the latest tarball, 
    see https://github.com/spack/spack/pull/13830 for an example
  . announce on
       cig-all@geodynamics.org
       https://community.geodynamics.org/c/aspect
       dealii@googlegroups.com


Announcement for 2.1.0 (April 29, 2019)
-----------------------------------------
We are pleased to announce the release of ASPECT 2.1.0. ASPECT is the Advanced
Solver for Problems in Earth's ConvecTion. It uses modern numerical methods such
as adaptive mesh refinement, multigrid, and a modular software design to
provide a fast, flexible, and extensible mantle convection solver. ASPECT is
available from

                   https://aspect.geodynamics.org/

and the release is available from

        https://geodynamics.org/cig/software/aspect/

and

        https://github.com/geodynamics/aspect/releases/tag/v2.1.0

This release includes the following significant changes:
- New: ASPECT has a new plugin system that allows it to prescribe a fixed
  heat flux (instead of prescribing the temperature) at the model boundaries.
- New: Compositional fields can optionally be advected with the melt velocity.
- New: There is now a visualization postprocessor that outputs the compaction
  length, the characteristic length scale of melt transport.
- New: ASPECT can optionally use the Geodynamic World Builder
  (https://github.com/GeodynamicWorldBuilder/WorldBuilder/) to create complex
  initial conditions for temperature and composition.
- New: ASPECT can now read in a depth-dependent vs to density conversion file, which
  can be used with the included tomography model plugins.
- New: ASPECT can now read in a depth-dependent initial temperature from file.
- New: The 'ascii data' and 'function' boundary velocity plugins now allow
  velocities to be specified along spherical (up, east, north) unit vectors.
- New: Added a visualization plugin that directly outputs the strain rate tensor.
- New: ASPECT can now call PerpleX to calculate material properties, phase
  amounts and compositions on-the-fly. This model is provided as a
  proof-of-concept; more efficient procedures are required for production runs.
- New: ASPECT now outputs a dynamically generated URL based on used features to
  ask people to cite appropriate papers.
- New: ASPECT has two visualization postprocessors which calculate and output
  the grain lag angle and the infinite strain axis (ISA) rotation timescale,
  respectively. These two quantities can be used to calculate the grain
  orientation lag parameter of Kaminski and Ribe (G3, 2002).
- Improved: The artificial diffusion term that is added in the entropy
  viscosity method to the temperature and composition equations is now computed
  as the maximum of the physical diffusion and entropy viscosity instead of the
  sum. This reduces numerical diffusion for the temperature field.
- New: Compositional fields can now be prescribed to a value that is computed
  in the material model as an additional output at every time step.
- Changed: The heat flux through boundary cells is now computed using the
  consistent boundary flux method as described in Gresho, et al. (1987), which
  is much more accurate than the previously used method.
- New: ASPECT can now calculate gravity anomalies in addition to the geoid.
- New: ASPECT now outputs a file named original.prm in the output directory
  with the exact content of the parameter it got started with.
- New: Added basic support for a volume-of-fluid interface tracking advection
  method in 2D incompressible box models. The VoF method is an efficient method
  to track a distinct compositional field without artificial diffusion.
- New: There is now an option to output visualization data as higher order
  polynomials. This is an improvement in accuracy and requires less disk space
  than the 'Interpolate output' option that was available before. However the
  new output can only be read by ParaView version 5.5 and newer and is
  therefore disabled by default.
- New: Several new benchmark cases were added.
- Many other fixes and smaller improvements.

A complete list of changes and their contributing authors can be found at
  https://aspect.geodynamics.org/doc/doxygen/changes_between_2_80_80_and_2_81_80.html

Wolfgang Bangerth, Juliane Dannberg, Rene Gassmoeller, Timo Heister,
Jacqueline Austermann, Menno Fraters, Anne Glerum, John Naliboff,
and many other contributors.


Announcement for 2.0.1 (June 21, 2018)
-----------------------------------------
We are pleased to announce the release of ASPECT 2.0.1. ASPECT is the Advanced
Solver for Problems in Earth's ConvecTion. It uses modern numerical methods such
as adaptive mesh refinement, multigrid, and a modular software design to
provide a fast, flexible, and extensible mantle convection solver. ASPECT is
available from

                   https://aspect.geodynamics.org/

and the release is available from

        https://github.com/geodynamics/aspect/releases/tag/v2.0.1

This release is a bugfix release for 2.0.0 and includes the following fixes:
- Fixed: The 'compositional heating' heating plugin had a parameter
  'Use compositional field for heat production averaging' that was used
  inconsistently with its description. Its first entry did not correspond
  to the background field, but to the first compositional field, and the
  last value was ignored. This is fixed now, the first entry is used for
  the background field, and all following values determine whether to include
  the corresponding compositional fields.
- Fixed: The 'depth dependent' material model did not properly initialize
  the material model it uses as a base model. This caused crashes if the
  base model requires an initialization (such as the 'steinberger' material
  model). This is fixed now by properly initializing the base model.
- Fixed: The advection assembler for DG elements was not thread-safe,
  which led to wrong results or crashes if a discontinuous temperature
  or composition discretization was combined with multithreading.
- Disabled: The particle functionality was not tested when combined with a
  free surface boundary, and this combination is currently not supported. This
  limitation is now made clear by failing for such setups with a descriptive
  error message.

Wolfgang Bangerth, Juliane Dannberg, Rene Gassmoeller, Timo Heister,
Jacqueline Austermann, Menno Fraters, Anne Glerum, John Naliboff,
and many other contributors.


Announcement for 2.0.0 (May 10, 2018)
-----------------------------------------
We are pleased to announce the release of ASPECT 2.0.0. ASPECT is the Advanced
Solver for Problems in Earth's ConvecTion. It uses modern numerical methods such
as adaptive mesh refinement, multigrid, and a modular software design to
provide a fast, flexible, and extensible mantle convection solver. ASPECT is
available from

                   https://aspect.geodynamics.org/

and the release is available from

        https://github.com/geodynamics/aspect/releases/tag/v2.0.0

This release includes the following changes:
- New: Newton solver and defect correction Picard iterations for nonlinear
  problems (for the Stokes system)
- Melt solver: Overhaul leading to improved performance and stability, better
  integration with other plugins
- New: Material model with grain size evolution
- New: Boundary temperature plugin with evolving core-mantle boundary
  temperature based on the heat flux through the core-mantle boundary
- New: ASPECT can now compute the geoid in 3D spherical shell geometry
- New: Operator splitting for reactions between compositional fields
- New: Added a PREM gravity profile
- Improved: Significantly reduced memory consumption in models that use many
  compositional fields
- Improved: A large number of performance improvements for preconditioners,
  assembly, seismic tomography initial conditions, and lateral averaging
- Improved: More flexibility for boundary and initial conditions, different
  plugins can be combined
- Improved: The dynamic topography postprocessor now uses the consistent
  boundary flux method for computing surface stresses, which is significantly
  more accurate
- New: Additional RHS force terms in the Stokes system can be added
- New particle interpolators: nearest neighbor, bilinear least squares,
  harmonic average
- New: Graphical user interface for the creation and modification of input
  parameter files
- Many other fixes and small improvements.
- Rework: Updated parameter and section names to make them more consistent and
  easier to understand. A script for updating parameter and source files is
  provided with the release.

A complete list of changes can be found at
  https://aspect.geodynamics.org/doc/doxygen/changes_between_1_85_80_and_2_80_80.html

Wolfgang Bangerth, Juliane Dannberg, Rene Gassmoeller, Timo Heister,
Jacqueline Austermann, Menno Fraters, Anne Glerum, John Naliboff,
and many other contributors.


Announcement for 1.5.0 (February 28, 2017)
-----------------------------------------
We are pleased to announce the release of ASPECT 1.5.0. ASPECT is the Advanced
Solver for Problems in Earth's ConvecTion. It uses modern numerical methods such
as adaptive mesh refinement, multigrid, and a modular software design to
provide a fast, flexible, and extensible mantle convection solver. ASPECT is
available from

                   https://aspect.dealii.org/

and the release is available from

        https://github.com/geodynamics/aspect/releases/tag/v1.5.0

This release includes the following changes:

- New: Choice between different formulations for the governing equations
  including Boussinesq and anelastic liquid approximation.
- New: Melt transport (two-phase flow).
- Particles: new generators, ghost exchange, performance improvements,
  interpolation to fields.
- New: Nondimensional material model for incompressible (using the Boussinesq
  approximation) and compressible computations (with ALA or TALA) for
  nondimensionalized problems. This can be used for benchmark problems like
  Blankenbach, King, etc..
- New: Optional DG method for temperature/composition.
- Adiabatic conditions: rework, now includes a reference density profile.
- Free surface: overhaul.
- New cookbooks: continental extension, finite strain, BurnMan interface,
  active tracers.
- New benchmarks: TanGurnis, Blankenbach, King.
- New: viscoplastic material model.
- Material model interface cleanup.
- Assembly performance improvements.
- New: memory statistics postprocessor.
- New: initial topography plugins.
- Many other fixes and small improvements.

A complete list of changes can be found at
  https://aspect.dealii.org/doc/doxygen/changes_between_1_84_80_and_1_85_80.html
and the release is also available from
  https://github.com/geodynamics/aspect/releases/tag/v1.5.0

Wolfgang Bangerth, Juliane Dannberg, Rene Gassmoeller, Timo Heister, and many
other contributors.


Announcement for 1.4.0 (May 15, 2016)
-----------------------------------------
We are pleased to announce the release of ASPECT 1.4.0. ASPECT is the Advanced
Solver for Problems in Earth's ConvecTion. It uses modern numerical methods such
as adaptive mesh refinement, multigrid, and a modular software design to
provide a fast, flexible, and extensible mantle convection solver. ASPECT is
available from

                   https://aspect.dealii.org/

and the release is available from

        https://github.com/geodynamics/aspect/releases/tag/v1.4.0

This release includes the following changes:
- Complete overhaul of the particle architecture.
- Modularization of the assembly process.
- Large improvements to serial and parallel performance of particle handling.
- Support for traction boundary conditions.
- Support for time-dependent mesh refinement criteria.
- Flexible support for modifying the underlying FEM variables for the PDE.
- Optional DG support for temperature and compositional fields.
- More robust parallel file I/O.
- Support for tangential mesh velocity boundaries in free surface
  computations.
- Support for anisotropic viscosity.
- Various fixes to free surface computations: checkpointing, better
  stabilization, crash fixes
- New Chunk Geometry model.
- New material property averaging options.
- Complete rewrite of the heating model infrastructure.
- Several new cookbooks.
- Several new postprocessors.
- Support for signals in various locations that allows plugins to
  inspect/manipulate things inside the core application.
- Several new mesh refinement plugins.
- Improved spherical interpolation of data used in the GPlates plugin. 
- Many other fixes and small improvements.

A complete list of changes can be found at
  https://aspect.dealii.org/doc/doxygen/changes_between_1_83_and_1_84_80.html
and the release is also available from
  https://github.com/geodynamics/aspect/releases/tag/v1.4.0

Wolfgang Bangerth, Timo Heister, and many other contributors.





Announcement for 1.3 (May 18, 2015)
-----------------------------------------
We are pleased to announce the release of ASPECT 1.3. ASPECT is the Advanced
Solver for Problems in Earth's ConvecTion. It uses modern numerical methods such
as adaptive mesh refinement, multigrid, and a modular software design to
provide a fast, flexible, and extensible mantle convection solver. ASPECT is
available from

                   https://aspect.dealii.org/

and the release is available from

        https://github.com/geodynamics/aspect/releases/tag/v1.3

This release includes the following changes:
- New: Averaging of material properties between the quadrature points of a
  cell. This greatly increases the stability of solutions in simulations with
  spatially varying coefficients, and also greatly accelerates the solution,
  at times up to a factor of ten.
- Corrections to the entropy stabilization scheme for compositional fields.
- Fixed and extended: Removal of rigid body translations and rotations when
  the simulation has a nullspace.
- New: VTU visualization output can now be grouped into an arbitrary number of
  files per time step.
- Various fixes to the nonlinear solver residual computation.
- New visualization postprocessors that can output the shear stress and full
  stress tensors.
- Fixes to the latent heat formulation.
- New 'ascii data' plugins for boundary and initial conditions.
- New mass flux statistics postprocessor.
- Many other fixes and small improvements.

A complete list of changes can be found at
  https://aspect.dealii.org/doc/doxygen/changes_between_1_82_and_1_83.html
and the release is also available from
  https://github.com/geodynamics/aspect/releases/tag/v1.3

Wolfgang Bangerth, Timo Heister, and many other contributors.




Announcement for 1.2 (January 25rd, 2015)
-----------------------------------------
We are pleased to announce the release of ASPECT 1.2. ASPECT is the Advanced
Solver for Problems in Earth's ConvecTion. It uses modern numerical methods such
as adaptive mesh refinement, multigrid, and a modular software design to
provide a fast, flexible and extensible mantle convection solver. ASPECT is
available from

                   http://aspect.dealii.org/

This release includes the following changes:
- methods to have truly concentric shells without distorted cells
- linear solver improvements which give up to 2x speedup in some cases
- boundary names like "top" instead of numbers are now supported in input files
- new example: free surface computation with a crust as a stagnant lid
- new benchmarks: Davies et al. and Burstedde et al.
- new initial condition: S40RTS perturbation based on shear wave data
- fixes to minimum/maximum refinement plugins
- better error messages when linear solvers fail
- many other fixes and small improvements (direct solver, file output,
  checkpointing, etc.)

A complete list of changes can be found at
  http://aspect.dealii.org/doc/doxygen/changes_between_1_81_and_1_82.html

Wolfgang Bangerth, Timo Heister, and many other contributors.



Announcement for 1.1 (June 1st, 2014)
---------------------
We are pleased to announce the release of ASPECT 1.1. ASPECT is the Advanced
Solver for Problems in Earth ConvecTion. It uses modern numerical methods such
as adaptive mesh refinement, multigrid, and a modular software design to
provide a fast, flexible and extensible mantle convection solver. ASPECT is
available from

                   http://aspect.dealii.org/

This release combines the incredible number of changes made during the
ASPECT hackathon in May 2014, as well as other changes made since the
last release. In particular, it includes the following changes:
- fixes to Stokes solver tolerance (users might need to change settings!)
- free surface computations
- optional direct solver support
- new material models (multi-component, simple compressible, ...)
- finer mesh refinement control using plugins
- updates to dynamic topography postprocessors
- updates to gplates boundary conditions
- compositional fields can now react with each other
- new cookbooks: reaction between fields, free surfaces
- improved PETSc support
- boundary conditions can now be time dependent 
- support for radiogenic heating models

Wolfgang Bangerth, Timo Heister, and many other contributors.


Announcement for 1.0:
---------------------
We are pleased to announce the release of ASPECT 1.0. ASPECT is the Advanced
Solver for Problems in Earth ConvecTion. It uses modern numerical methods such
as adaptive mesh refinement, multigrid, and a modular software design to
provide a fast, flexible and extensible mantle convection solver. ASPECT is
available from

                   http://aspect.dealii.org/

This release contains a large number of changes, incorporating about one year
of work of the main authors and many contributors:
- a lot of new documentation
- new examples (2d/3d shells, GPlates, ...)
- option to remove rotational/translational modes
- big performance improvements
- compositional fields: reactions, boundary conditions
- support for periodic meshes
- output of dynamic topography
- incorporation of latent heat
- experimental PETSc support

Wolfgang Bangerth, Timo Heister, and many other contributors.





Announcement for 0.3:
---------------------
We are pleased to announce the release of ASPECT 0.3. ASPECT is the Advanced
Solver for Problems in Earth ConvecTion. It uses modern numerical methods such
as adaptive mesh refinement, multigrid, and a modular software design to
provide a fast, flexible and extensible mantle convection solver. ASPECT is
available from

                   http://aspect.dealii.org/

This is primarily a bug fix release. It fixes a bug in the computation of adiabatic initial temperature conditions when specifying inner or outer boundary layers (thanks to Juliane Dannberg for finding and fixing it). The doxygen-generated documentation now also automatically cross-links to deal.II classes wherever they are referenced in ASPECT.

Wolfgang Bangerth, Timo Heister.




Announcement for 0.2:
---------------------
We are pleased to announce the release of ASPECT 0.2. ASPECT is the Advanced
Solver for Problems in Earth ConvecTion. It uses modern numerical methods such
as adaptive mesh refinement, multigrid, and a modular software design to
provide a fast, flexible and extensible mantle convection solver. ASPECT is
available from

                    http://aspect.dealii.org/

This release adds a significant number of new features, including:
   - support for active and passive "compositional" fields (courtesy of
     Juliane Dannberg)
   - more flexibility to output only some variables, drastically reducing
     the amount of data written
   - support for user-defined mesh refinement criteria
   - support for GPlates-generated velocity boundary conditions (courtesy
     of Rene Gassmoeller)
   - support for passive tracer particles
   - provision of an "introspection" module as part of the source code
     to make it easier and less error-prone to write extension code
In addition, the manual has been significantly expanded, with many new
cookbooks, and we have fixed a number of bugs. A list of changes is
available here:

  http://aspect.dealii.org/doc/doxygen/changes_between_0_81_and_0_82.html

Wolfgang Bangerth, Timo Heister, and many other contributors.


